INFO:__main__:AI service started with lazy loading support
INFO:     Will watch for changes in these directories: ['/root/autodl-tmp/EasyVideo/ai-service']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [6160] using WatchFiles
INFO:__mp_main__:AI service started with lazy loading support
INFO:api_server:AI service started with lazy loading support
INFO:     Started server process [6286]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:36812 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:36826 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:36830 - "GET /health HTTP/1.1" 200 OK
INFO:modules.image_generator:FLUX model path configured: /root/autodl-tmp/black-forest-labs/FLUX.1-Kontext-dev
INFO:api_server:ImageGenerator initialized on demand
INFO:modules.image_generator:Loading FLUX.1-Krea-dev model on demand from: /root/autodl-tmp/black-forest-labs/FLUX.1-Kontext-dev
Loading pipeline components...:   0%|          | 0/7 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 21.78it/s]
Loading pipeline components...:  14%|â–ˆâ–        | 1/7 [00:00<00:01,  3.57it/s]Loading pipeline components...:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 4/7 [00:00<00:00, 11.47it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A
Loading checkpoint shards:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:00<00:00,  9.15it/s][A
Loading checkpoint shards:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  9.47it/s][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00, 11.70it/s]
Loading pipeline components...:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 6/7 [00:00<00:00,  6.90it/s]You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
Loading pipeline components...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7/7 [00:01<00:00,  6.26it/s]
INFO:modules.image_generator:FLUX.1-Krea-dev model loaded successfully
INFO:modules.prompt_optimizer:Qwen model path configured: /root/autodl-tmp/Qwen/Qwen2.5-VL-3B-Instruct
INFO:modules.prompt_optimizer:Optimizing prompt: ä¸€åªå°çŒ«ååœ¨èŠ±å›­é‡Œ, æ¸©æŸ”çš„æ‘‡å¤´ç¬‘ç€, 8kåˆ†è¾¨çŽ‡
INFO:modules.prompt_optimizer:Optimization type: é€šç”¨åž‹
INFO:modules.prompt_optimizer:Task type: image
INFO:modules.prompt_optimizer:Model not loaded, initializing now...
INFO:modules.prompt_optimizer:Loading Qwen2.5-VL model on demand...
INFO:accelerate.utils.modeling:We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:01<00:01,  1.96s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:03<00:00,  1.76s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:03<00:00,  1.79s/it]
The image processor of type `Qwen2VLImageProcessor` is now loaded as a fast processor by default, even if the model checkpoint was saved with a slow processor. This is a breaking change and may produce slightly different outputs. To continue using the slow processor, instantiate this class with `use_fast=False`. Note that this behavior will be extended to all models in a future release.
You have video processor config saved in `preprocessor.json` file which is deprecated. Video processor configs should be saved in their own `video_preprocessor.json` file. You can rename the file or load and save the processor back which renames it automatically. Loading from `preprocessor.json` will be removed in v5.0.
INFO:modules.prompt_optimizer:Qwen2.5-VL model loaded successfully
INFO:modules.prompt_optimizer:AI optimized prompt: A small cat sitting in a garden, gently swaying its head and smiling softly, with vibrant colors, detailed fur texture, soft lighting, natural composition, high-resolution 8K quality.
INFO:modules.prompt_optimizer:Unloading Qwen2.5-VL model to free memory...
INFO:modules.prompt_optimizer:Qwen2.5-VL model unloaded successfully
INFO:modules.image_generator:Original prompt: ä¸€åªå°çŒ«ååœ¨èŠ±å›­é‡Œ, æ¸©æŸ”çš„æ‘‡å¤´ç¬‘ç€, 8kåˆ†è¾¨çŽ‡
INFO:modules.image_generator:Optimized prompt: A small cat sitting in a garden, gently swaying its head and smiling softly, with vibrant colors, detailed fur texture, soft lighting, natural composition, high-resolution 8K quality.
INFO:modules.image_generator:Generating 1 images with FLUX model
INFO:modules.image_generator:Prompt: A small cat sitting in a garden, gently swaying its head and smiling softly, with vibrant colors, detailed fur texture, soft lighting, natural composition, high-resolution 8K quality.
INFO:modules.image_generator:Size: 512x512, Seed: 188911
INFO:modules.image_generator:Generating image 1/1 with seed 188911
  0%|          | 0/28 [00:00<?, ?it/s]  4%|â–Ž         | 1/28 [00:10<04:52, 10.83s/it]  7%|â–‹         | 2/28 [00:13<02:41,  6.19s/it] 11%|â–ˆ         | 3/28 [00:16<01:55,  4.62s/it] 14%|â–ˆâ–        | 4/28 [00:19<01:32,  3.86s/it] 18%|â–ˆâ–Š        | 5/28 [00:21<01:19,  3.45s/it] 21%|â–ˆâ–ˆâ–       | 6/28 [00:24<01:10,  3.21s/it] 25%|â–ˆâ–ˆâ–Œ       | 7/28 [00:27<01:03,  3.04s/it] 29%|â–ˆâ–ˆâ–Š       | 8/28 [00:30<00:58,  2.94s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 9/28 [00:32<00:54,  2.87s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 10/28 [00:35<00:50,  2.83s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 11/28 [00:38<00:47,  2.81s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 12/28 [00:41<00:44,  2.78s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 13/28 [00:43<00:41,  2.76s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 14/28 [00:46<00:38,  2.75s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 15/28 [00:49<00:35,  2.74s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 16/28 [00:51<00:32,  2.74s/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 17/28 [00:54<00:29,  2.73s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 18/28 [00:57<00:27,  2.72s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 19/28 [01:00<00:24,  2.72s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 20/28 [01:02<00:21,  2.70s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 21/28 [01:05<00:18,  2.71s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 22/28 [01:08<00:16,  2.70s/it] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 23/28 [01:10<00:13,  2.69s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 24/28 [01:13<00:10,  2.69s/it] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 25/28 [01:16<00:08,  2.69s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 26/28 [01:18<00:05,  2.70s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 27/28 [01:21<00:02,  2.71s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 28/28 [01:24<00:00,  2.72s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 28/28 [01:24<00:00,  3.01s/it]
INFO:modules.image_generator:Unloading FLUX model to free memory...
INFO:modules.image_generator:FLUX model unloaded successfully
INFO:api_server:ImageGenerator model unloaded successfully
INFO:     127.0.0.1:57660 - "POST /image/generate HTTP/1.1" 200 OK
INFO:     127.0.0.1:38572 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:38580 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:38588 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:38602 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:38614 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:59432 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:59440 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:59444 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:59458 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:59462 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:38996 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:39008 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:39018 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:39022 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:39032 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:58746 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:58760 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:58766 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:58772 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:58778 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:48728 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:48738 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:48746 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:48754 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:48768 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:43482 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:43496 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:43508 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:43512 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:43516 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:52004 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:52020 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:52024 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:52038 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:52046 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:39980 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:39996 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:40010 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:40018 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:40034 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:41146 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:41148 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:41156 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:41160 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:41170 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:41182 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:55052 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:55066 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:     127.0.0.1:55074 - "GET /task/progress/00e0bdd1-696a-4422-80ca-4ba6c673cd96 HTTP/1.1" 200 OK
INFO:modules.image_generator:Loading FLUX.1-Krea-dev model on demand from: /root/autodl-tmp/black-forest-labs/FLUX.1-Kontext-dev
Loading pipeline components...:   0%|          | 0/7 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 47.33it/s]
Loading pipeline components...:  14%|â–ˆâ–        | 1/7 [00:00<00:00,  7.60it/s]Loading pipeline components...:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 4/7 [00:00<00:00, 17.15it/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00, 24.90it/s][ALoading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00, 24.84it/s]
Loading pipeline components...:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 6/7 [00:00<00:00, 11.93it/s]Loading pipeline components...: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7/7 [00:00<00:00,  9.09it/s]
INFO:modules.image_generator:FLUX.1-Krea-dev model loaded successfully
INFO:modules.prompt_optimizer:Qwen model path configured: /root/autodl-tmp/Qwen/Qwen2.5-VL-3B-Instruct
INFO:modules.prompt_optimizer:Optimizing prompt: ä¸€åªå°çŒ«ååœ¨èŠ±å›­é‡Œ
INFO:modules.prompt_optimizer:Optimization type: é€šç”¨åž‹
INFO:modules.prompt_optimizer:Task type: image
INFO:modules.prompt_optimizer:Model not loaded, initializing now...
INFO:modules.prompt_optimizer:Loading Qwen2.5-VL model on demand...
INFO:accelerate.utils.modeling:We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:01<00:01,  1.16s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:02<00:00,  1.01it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:02<00:00,  1.02s/it]
INFO:modules.prompt_optimizer:Qwen2.5-VL model loaded successfully
INFO:modules.prompt_optimizer:AI optimized prompt: A small kitten sitting in a lush, vibrant garden with rich green grass and colorful flowers. The kitten has soft fur, with shades of white and gray on its body, and a bright blue eye. Shadows cast by the sunlight create a beautiful contrast between light and dark areas. The composition features the kitten positioned slightly off-center to the right, adding a dynamic element to the scene. Use high-resolution textures for the foliage and petals, ensuring smooth gradients and detailed highlights that capture the natural beauty of the environment.
INFO:modules.prompt_optimizer:Unloading Qwen2.5-VL model to free memory...
INFO:modules.prompt_optimizer:Qwen2.5-VL model unloaded successfully
INFO:modules.image_generator:Original prompt: ä¸€åªå°çŒ«ååœ¨èŠ±å›­é‡Œ
INFO:modules.image_generator:Optimized prompt: A small kitten sitting in a lush, vibrant garden with rich green grass and colorful flowers. The kitten has soft fur, with shades of white and gray on its body, and a bright blue eye. Shadows cast by the sunlight create a beautiful contrast between light and dark areas. The composition features the kitten positioned slightly off-center to the right, adding a dynamic element to the scene. Use high-resolution textures for the foliage and petals, ensuring smooth gradients and detailed highlights that capture the natural beauty of the environment.
INFO:modules.image_generator:Generating 1 images with FLUX model
INFO:modules.image_generator:Prompt: A small kitten sitting in a lush, vibrant garden with rich green grass and colorful flowers. The kitten has soft fur, with shades of white and gray on its body, and a bright blue eye. Shadows cast by the sunlight create a beautiful contrast between light and dark areas. The composition features the kitten positioned slightly off-center to the right, adding a dynamic element to the scene. Use high-resolution textures for the foliage and petals, ensuring smooth gradients and detailed highlights that capture the natural beauty of the environment.
INFO:modules.image_generator:Size: 512x512, Seed: 688496
INFO:modules.image_generator:Generating image 1/1 with seed 688496
Token indices sequence length is longer than the specified maximum sequence length for this model (107 > 77). Running this sequence through the model will result in indexing errors
The following part of your input was truncated because CLIP can only handle sequences up to 77 tokens: ['scene. use high - resolution textures for the foliage and petals, ensuring smooth gradients and detailed highlights that capture the natural beauty of the environment.']
  0%|          | 0/28 [00:00<?, ?it/s]  4%|â–Ž         | 1/28 [00:03<01:34,  3.49s/it]  7%|â–‹         | 2/28 [00:06<01:18,  3.03s/it] 11%|â–ˆ         | 3/28 [00:08<01:12,  2.89s/it] 14%|â–ˆâ–        | 4/28 [00:11<01:07,  2.82s/it] 18%|â–ˆâ–Š        | 5/28 [00:14<01:04,  2.79s/it] 21%|â–ˆâ–ˆâ–       | 6/28 [00:17<01:00,  2.77s/it] 25%|â–ˆâ–ˆâ–Œ       | 7/28 [00:19<00:57,  2.76s/it] 29%|â–ˆâ–ˆâ–Š       | 8/28 [00:22<00:54,  2.75s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 9/28 [00:25<00:52,  2.74s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 10/28 [00:28<00:49,  2.74s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 11/28 [00:30<00:46,  2.73s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 12/28 [00:33<00:43,  2.74s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 13/28 [00:36<00:42,  2.80s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 14/28 [00:39<00:38,  2.78s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 15/28 [00:41<00:35,  2.77s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 16/28 [00:44<00:32,  2.75s/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 17/28 [00:47<00:29,  2.72s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 18/28 [00:49<00:27,  2.70s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 19/28 [00:52<00:24,  2.69s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 20/28 [00:55<00:21,  2.69s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 21/28 [00:57<00:18,  2.70s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 22/28 [01:00<00:16,  2.71s/it] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 23/28 [01:03<00:13,  2.71s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 24/28 [01:06<00:10,  2.71s/it] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 25/28 [01:08<00:08,  2.71s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 26/28 [01:11<00:05,  2.71s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 27/28 [01:14<00:02,  2.71s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 28/28 [01:17<00:00,  2.72s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 28/28 [01:17<00:00,  2.75s/it]
INFO:modules.image_generator:Unloading FLUX model to free memory...
INFO:modules.image_generator:FLUX model unloaded successfully
INFO:api_server:ImageGenerator model unloaded successfully
INFO:     127.0.0.1:47084 - "POST /image/generate HTTP/1.1" 200 OK
INFO:     127.0.0.1:45384 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:modules.prompt_optimizer:Qwen model path configured: /root/autodl-tmp/Qwen/Qwen2.5-VL-3B-Instruct
INFO:api_server:PromptOptimizer initialized on demand
INFO:modules.prompt_optimizer:Optimizing prompt: ä¸€åªå°çŒ«ååœ¨èŠ±å›­é‡Œ
INFO:modules.prompt_optimizer:Optimization type: é€šç”¨åž‹
INFO:modules.prompt_optimizer:Task type: image
INFO:modules.prompt_optimizer:Model not loaded, initializing now...
INFO:modules.prompt_optimizer:Loading Qwen2.5-VL model on demand...
INFO:accelerate.utils.modeling:We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  1.19it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:01<00:00,  1.41it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:01<00:00,  1.37it/s]
INFO:modules.prompt_optimizer:Qwen2.5-VL model loaded successfully
INFO:modules.prompt_optimizer:AI optimized prompt: "tiny kitten sitting in a lush garden, with vibrant green grass and blooming flowers surrounding it; the kitten is wearing a cozy blue sweater made of soft wool, casting gentle shadows on the ground due to dappled sunlight filtering through the leaves above; the composition includes a wide-angle view capturing both the kitten and its natural environment, enhancing depth and perspective for an immersive experience."
INFO:modules.prompt_optimizer:Unloading Qwen2.5-VL model to free memory...
INFO:modules.prompt_optimizer:Qwen2.5-VL model unloaded successfully
INFO:api_server:PromptOptimizer model unloaded successfully
INFO:     127.0.0.1:45398 - "POST /prompt/optimize HTTP/1.1" 200 OK
INFO:     127.0.0.1:45400 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:45412 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:45422 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:45426 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:33746 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:33762 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:33770 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:33780 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:33796 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:43824 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:43834 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:43836 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:43842 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:43858 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:52104 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:52118 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:52128 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:52142 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:52144 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:35300 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:35312 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:35316 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:35330 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:35342 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:54782 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:54794 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:54804 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:54820 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:54824 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:39162 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:39174 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:39184 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:39192 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:39204 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:54190 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:54204 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:54212 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:54220 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:54236 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:40786 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:40800 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
INFO:     127.0.0.1:40816 - "GET /task/progress/2acb4925-b2ee-482e-88a2-2ef25924e25f HTTP/1.1" 200 OK
